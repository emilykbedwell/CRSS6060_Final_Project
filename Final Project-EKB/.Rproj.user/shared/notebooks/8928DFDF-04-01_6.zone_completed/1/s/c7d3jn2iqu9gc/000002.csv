"0","library(starsExtra)"
"0","library(gstat)"
"0",""
"0","zone_s <- zone_df %>%"
"0","  dplyr::select(cluster) %>%"
"0","  # Transforming from polygon to point"
"0","  st_cast(""POINT"") %>%"
"0","  # Transforming from geometry to xy (needed by the focal function)"
"0","  st_sfc2xy() %>%"
"0","  # Transforming from point (vector) to raster"
"0","  st_as_stars() %>%"
"0","  # Applying focal filter"
"0","  focal2(w = matrix(1,5,5),"
"0","         fun = ""mean"") %>%"
"0","  # Transforming from raster back to vector"
"0","  st_as_sf() %>%"
"0","  # Interpolating to fill to boundary"
"0","  gstat(formula = cluster ~ 1,  "
"0","                       data = .) %>%"
"0","  predict(grid_r) %>%"
"0","  # Transforming from raster back to vector"
"0","  st_as_sf() %>%"
"0","  # Adjusting cluster id from numeric to factor"
"0","  mutate(cluster_s=ifelse(var1.pred<1.5,""1"",""2""),"
"0","         cluster_s=factor(cluster_s)) %>%"
"0","  dplyr::select(cluster_s) "
"2","Warning in st_cast.sf(., ""POINT"") :"
"2","
 "
"2"," repeating attributes for all sub-geometries for which they may not be constant
"
"1","[inverse distance weighted interpolation]
"
"0","zone_s"
"1","Simple feature collection with 4032 features and 1 field"
"1","
"
"1","Geometry type: POLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: 712930.9 ymin: 3452174 xmax: 713580.9 ymax: 3453164"
"1","
"
"1","Projected CRS: NAD83(2011) / UTM zone 16N
"
"1","First 10 features:
"
"1","  "
"1"," cluster_s"
"1","                       geometry"
"1","
1 "
"1","         1"
"1"," POLYGON ((713230.9 3453164,..."
"1","
2 "
"1","         1"
"1"," POLYGON ((713240.9 3453164,..."
"1","
3 "
"1","         1"
"1"," POLYGON ((713250.9 3453164,..."
"1","
4 "
"1","         1"
"1"," POLYGON ((713190.9 3453154,..."
"1","
5 "
"1","         1"
"1"," POLYGON ((713200.9 3453154,..."
"1","
6 "
"1","         1"
"1"," POLYGON ((713210.9 3453154,..."
"1","
7 "
"1","         1"
"1"," POLYGON ((713220.9 3453154,..."
"1","
8 "
"1","         1"
"1"," POLYGON ((713230.9 3453154,..."
"1","
9 "
"1","         1"
"1"," POLYGON ((713240.9 3453154,..."
"1","
10"
"1","         1"
"1"," POLYGON ((713250.9 3453154,..."
"1","
"
